{"ast":null,"code":"var _jsxFileName = \"/Users/Gabi/Documents/Basics-Miu/Basics/frontend/src/Cart/CartPage.jsx\";\nimport React, { Component } from \"react\";\nimport AuthenticationService from \"../service/AuthenticationService.js\";\nimport AppNav from \"../AppNav\";\nimport { Form, Col, Button } from \"react-bootstrap\";\nimport { Redirect } from \"react-router-dom\";\nimport axios from \"axios\";\nimport { createBrowserHistory } from \"history\";\nexport const history = createBrowserHistory({\n  forceRefresh: true\n});\n\nclass CartPage extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true,\n      Products: [],\n      userId: null\n    };\n\n    this.updateQuntity = id => {\n      var {\n        Products\n      } = this.state;\n      const data = {\n        productId: Products[id].product.id,\n        quantity: Products[id].quantity\n      };\n      console.log(data); // e.preventDefault();\n      // console.log(this.state);\n\n      var config = {\n        headers: {\n          \"Access-Control-Allow-Origin\": true,\n          \"Access-Control-Allow-Methods\": \"OPTIONS,GET,PUT,POST,DELETE\",\n          \"Access-Control-Allow-Headers\": \"X-Requested-With, Content-Type\",\n          Authorization: AuthenticationService.getToken()\n        }\n      };\n      axios.post(\"http://localhost:8081/carts\", data, config).then(response => {\n        console.log(response);\n      }).catch(error => {\n        console.log(error);\n      });\n    };\n\n    this.handleCheckout = () => {\n      var config = {\n        headers: {\n          \"Access-Control-Allow-Origin\": true,\n          \"Access-Control-Allow-Methods\": \"OPTIONS,GET,PUT,POST,DELETE\",\n          \"Access-Control-Allow-Headers\": \"X-Requested-With, Content-Type\",\n          Authorization: AuthenticationService.getToken()\n        }\n      };\n      var data = {};\n      axios.post(\"http://localhost:8081/carts/checkout\", data, config).then(response => {\n        console.log(response);\n        this.props.history.push(\"/\");\n      }).catch(error => {\n        console.log(error);\n      });\n    };\n  }\n\n  async componentDidMount() {\n    //const { id } = this.props.match.params;\n    console.log(AuthenticationService.getLoggedInUserName()); //console.log(typeof Response);\n\n    const responseUser = await fetch(`../users/search/${AuthenticationService.getLoggedInUserName()}`);\n    console.log(responseUser);\n    const bodyUser = await responseUser.json();\n    this.setState({\n      userId: bodyUser.id\n    });\n    const response = await fetch(`/carts/myCart/${this.state.userId}`);\n    console.log(response);\n    const body = await response.json();\n    console.log(body);\n    this.setState({\n      Products: body,\n      isLoading: false\n    });\n  }\n\n  handleChange(event) {\n    this.setState({\n      [event.target.name]: event.target.value\n    });\n  }\n\n  loginClicked() {\n    console.log(this.state); //executeSignUp\n\n    AuthenticationService.executeSignUp(this.state.password, this.state.firstName, this.state.lastName, this.state.email).then(response => {\n      AuthenticationService.registerSuccessfulLogin(this.state.email, this.state.password);\n      AuthenticationService.setUpRoles(this.state.email);\n      this.props.history.push(\"/\");\n    }).catch(error => {\n      console.log(error.response.data.message);\n      this.setState({\n        errorMsg: error.response.data.message,\n        showSuccessMessage: true\n      });\n    });\n  }\n\n  decreaseQuantity(id) {\n    console.log(id);\n    var {\n      Products\n    } = this.state;\n    console.log(Products);\n\n    if (Products[parseInt(id)].quantity > 0) {\n      Products[parseInt(id)].quantity = Products[parseInt(id)].quantity - 1;\n      this.setState({\n        Products: Products\n      });\n      this.updateQuntity(id);\n    } else {\n      console.log(Products[id]);\n      Products.splice(id, 1);\n      console.log(Products);\n      this.forceUpdate();\n    } // if (this.state.quantity > 0) {\n    //   this.setState({ quantity: this.state.quantity - 1 });\n    // }\n\n  }\n\n  increaseQuantity(id) {\n    var {\n      Products\n    } = this.state;\n    console.log(Products);\n\n    if (Products[parseInt(id)].quantity < Products[parseInt(id)].product.stock) {\n      Products[parseInt(id)].quantity = Products[parseInt(id)].quantity + 1;\n      this.setState({\n        Products: Products\n      });\n      this.updateQuntity(id);\n    }\n  }\n\n  render() {\n    const {\n      Products\n    } = this.state;\n    let total = 0;\n\n    for (const [index, value] of Products.entries()) {\n      total += value.product.price * value.quantity;\n    }\n\n    return /*#__PURE__*/React.createElement(\"html\", {\n      lang: \"en\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"head\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"meta\", {\n      charset: \"utf-8\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"link\", {\n      rel: \"shortcut icon\",\n      href: \"/favicon.ico\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"meta\", {\n      name: \"viewport\",\n      content: \"width=device-width, initial-scale=1\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"meta\", {\n      name: \"theme-color\",\n      content: \"#7350FF\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"link\", {\n      rel: \"manifest\",\n      href: \"/manifest.json\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"link\", {\n      href: \"css/main.css\",\n      rel: \"stylesheet\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"title\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 11\n      }\n    }, \"Cabify Checkout Challenge\")), /*#__PURE__*/React.createElement(\"body\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(AppNav, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"root\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"main\", {\n      class: \"App\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"section\", {\n      class: \"products\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      class: \"main\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 17\n      }\n    }, \"Shopping cart\"), /*#__PURE__*/React.createElement(\"ul\", {\n      class: \"products-list tableHead\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"li\", {\n      class: \"products-list-title row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-product\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 21\n      }\n    }, \"Product details\"), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-quantity\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 21\n      }\n    }, \"Quantity\"), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-price\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 21\n      }\n    }, \"Price\"), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-total\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 21\n      }\n    }, \"Total\"))), /*#__PURE__*/React.createElement(\"ul\", {\n      class: \"products-list\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 17\n      }\n    }, Products.map((product, index) => /*#__PURE__*/React.createElement(\"li\", {\n      class: \"product row\",\n      key: product.cartProductId,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-product\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"figure\", {\n      class: \"product-image\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: \"img/cap.png\",\n      alt: \"Cap\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 27\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"product-description\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 27\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 29\n      }\n    }, product.product.title), /*#__PURE__*/React.createElement(\"h6\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 29\n      }\n    }, \"Delete\")))), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-quantity\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      class: \"count\",\n      onClick: () => this.decreaseQuantity(index),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 25\n      }\n    }, \"-\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      class: \"product-quantity\",\n      value: product.quantity,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      class: \"count\",\n      onClick: () => this.increaseQuantity(index),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 25\n      }\n    }, \"+\")), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-price\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      class: \"product-price\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 25\n      }\n    }, product.product.price), /*#__PURE__*/React.createElement(\"span\", {\n      class: \"product-currency currency\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 25\n      }\n    }, \"\\u20AC\")), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-total\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      class: \"product-currency currency\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 25\n      }\n    }, \"$\"), /*#__PURE__*/React.createElement(\"span\", {\n      class: \"product-price\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 25\n      }\n    }, product.product.price * product.quantity)))))), /*#__PURE__*/React.createElement(\"aside\", {\n      class: \"summary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      class: \"main\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 17\n      }\n    }, \"Order Summary\"), /*#__PURE__*/React.createElement(\"ul\", {\n      class: \"summary-items wrapper border\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      class: \"summary-items-number\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 21\n      }\n    }, Products.length, \" Items\"), /*#__PURE__*/React.createElement(\"span\", {\n      class: \"summary-items-price\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 21\n      }\n    }, \"$\", /*#__PURE__*/React.createElement(\"span\", {\n      class: \"currency\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 24\n      }\n    }, total)))), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"summary-total wrapper\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"ul\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 264,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      class: \"summary-total-cost\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 23\n      }\n    }, \"Total cost\"), /*#__PURE__*/React.createElement(\"span\", {\n      class: \"summary-total-price\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 23\n      }\n    }, \"$\", total))), /*#__PURE__*/React.createElement(\"button\", {\n      type: \"submit\",\n      onClick: this.handleCheckout,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 269,\n        columnNumber: 19\n      }\n    }, \"Checkout\")))))));\n  }\n\n}\n\nexport default CartPage;","map":{"version":3,"sources":["/Users/Gabi/Documents/Basics-Miu/Basics/frontend/src/Cart/CartPage.jsx"],"names":["React","Component","AuthenticationService","AppNav","Form","Col","Button","Redirect","axios","createBrowserHistory","history","forceRefresh","CartPage","constructor","props","state","isLoading","Products","userId","updateQuntity","id","data","productId","product","quantity","console","log","config","headers","Authorization","getToken","post","then","response","catch","error","handleCheckout","push","componentDidMount","getLoggedInUserName","responseUser","fetch","bodyUser","json","setState","body","handleChange","event","target","name","value","loginClicked","executeSignUp","password","firstName","lastName","email","registerSuccessfulLogin","setUpRoles","message","errorMsg","showSuccessMessage","decreaseQuantity","parseInt","splice","forceUpdate","increaseQuantity","stock","render","total","index","entries","price","map","cartProductId","title","length"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport AuthenticationService from \"../service/AuthenticationService.js\";\nimport AppNav from \"../AppNav\";\nimport { Form, Col, Button } from \"react-bootstrap\";\nimport { Redirect } from \"react-router-dom\";\nimport axios from \"axios\";\nimport { createBrowserHistory } from \"history\";\nexport const history = createBrowserHistory({ forceRefresh: true });\n\nclass CartPage extends Component {\n  state = {\n    isLoading: true,\n    Products: [],\n    userId: null,\n  };\n\n  constructor(props) {\n    super(props);\n  }\n  async componentDidMount() {\n    //const { id } = this.props.match.params;\n    console.log(AuthenticationService.getLoggedInUserName());\n    //console.log(typeof Response);\n    const responseUser = await fetch(\n      `../users/search/${AuthenticationService.getLoggedInUserName()}`\n    );\n    console.log(responseUser);\n    const bodyUser = await responseUser.json();\n    this.setState({ userId: bodyUser.id });\n    const response = await fetch(`/carts/myCart/${this.state.userId}`);\n    console.log(response);\n    const body = await response.json();\n    console.log(body);\n    this.setState({\n      Products: body,\n      isLoading: false,\n    });\n  }\n\n  handleChange(event) {\n    this.setState({\n      [event.target.name]: event.target.value,\n    });\n  }\n\n  loginClicked() {\n    console.log(this.state);\n\n    //executeSignUp\n\n    AuthenticationService.executeSignUp(\n      this.state.password,\n      this.state.firstName,\n      this.state.lastName,\n      this.state.email\n    )\n      .then((response) => {\n        AuthenticationService.registerSuccessfulLogin(\n          this.state.email,\n          this.state.password\n        );\n        AuthenticationService.setUpRoles(this.state.email);\n        this.props.history.push(\"/\");\n      })\n      .catch((error) => {\n        console.log(error.response.data.message);\n        this.setState({\n          errorMsg: error.response.data.message,\n          showSuccessMessage: true,\n        });\n      });\n  }\n\n  updateQuntity = (id) => {\n    var { Products } = this.state;\n    const data = {\n      productId: Products[id].product.id,\n      quantity: Products[id].quantity,\n    };\n    console.log(data);\n    // e.preventDefault();\n    // console.log(this.state);\n    var config = {\n      headers: {\n        \"Access-Control-Allow-Origin\": true,\n        \"Access-Control-Allow-Methods\": \"OPTIONS,GET,PUT,POST,DELETE\",\n        \"Access-Control-Allow-Headers\": \"X-Requested-With, Content-Type\",\n        Authorization: AuthenticationService.getToken(),\n      },\n    };\n\n    axios\n      .post(\"http://localhost:8081/carts\", data, config)\n      .then((response) => {\n        console.log(response);\n      })\n      .catch((error) => {\n        console.log(error);\n      });\n  };\n\n  decreaseQuantity(id) {\n    console.log(id);\n    var { Products } = this.state;\n    console.log(Products);\n    if (Products[parseInt(id)].quantity > 0) {\n      Products[parseInt(id)].quantity = Products[parseInt(id)].quantity - 1;\n      this.setState({ Products: Products });\n      this.updateQuntity(id);\n    } else {\n      console.log(Products[id]);\n      Products.splice(id, 1);\n      console.log(Products);\n      this.forceUpdate();\n    }\n    // if (this.state.quantity > 0) {\n    //   this.setState({ quantity: this.state.quantity - 1 });\n    // }\n  }\n\n  increaseQuantity(id) {\n    var { Products } = this.state;\n    console.log(Products);\n    if (\n      Products[parseInt(id)].quantity < Products[parseInt(id)].product.stock\n    ) {\n      Products[parseInt(id)].quantity = Products[parseInt(id)].quantity + 1;\n      this.setState({ Products: Products });\n      this.updateQuntity(id);\n    }\n  }\n\n  handleCheckout = () => {\n    var config = {\n      headers: {\n        \"Access-Control-Allow-Origin\": true,\n        \"Access-Control-Allow-Methods\": \"OPTIONS,GET,PUT,POST,DELETE\",\n        \"Access-Control-Allow-Headers\": \"X-Requested-With, Content-Type\",\n        Authorization: AuthenticationService.getToken(),\n      },\n    };\n    var data = {};\n\n    axios\n      .post(\"http://localhost:8081/carts/checkout\", data, config)\n      .then((response) => {\n        console.log(response);\n        this.props.history.push(\"/\");\n      })\n      .catch((error) => {\n        console.log(error);\n      });\n  };\n\n  render() {\n    const { Products } = this.state;\n    let total = 0;\n    for (const [index, value] of Products.entries()) {\n      total += value.product.price * value.quantity;\n    }\n    return (\n      <html lang=\"en\">\n        <head>\n          <meta charset=\"utf-8\" />\n          <link rel=\"shortcut icon\" href=\"/favicon.ico\" />\n          <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n          <meta name=\"theme-color\" content=\"#7350FF\" />\n          <link rel=\"manifest\" href=\"/manifest.json\" />\n          <link href=\"css/main.css\" rel=\"stylesheet\" />\n          <title>Cabify Checkout Challenge</title>\n        </head>\n        <body>\n          <AppNav />\n          <div id=\"root\">\n            <main class=\"App\">\n              <section class=\"products\">\n                <h1 class=\"main\">Shopping cart</h1>\n                <ul class=\"products-list tableHead\">\n                  <li class=\"products-list-title row\">\n                    <div class=\"col-product\">Product details</div>\n                    <div class=\"col-quantity\">Quantity</div>\n                    <div class=\"col-price\">Price</div>\n                    <div class=\"col-total\">Total</div>\n                  </li>\n                </ul>\n                <ul class=\"products-list\">\n                  {Products.map((product, index) => (\n                    <li class=\"product row\" key={product.cartProductId}>\n                      <div class=\"col-product\">\n                        <figure class=\"product-image\">\n                          <img src=\"img/cap.png\" alt=\"Cap\" />\n                          <div class=\"product-description\">\n                            <h1>{product.product.title}</h1>\n                            <h6>Delete</h6>\n                          </div>\n                        </figure>\n                      </div>\n                      <div class=\"col-quantity\">\n                        <button\n                          class=\"count\"\n                          onClick={() => this.decreaseQuantity(index)}\n                        >\n                          -\n                        </button>\n                        <input\n                          type=\"text\"\n                          class=\"product-quantity\"\n                          value={product.quantity}\n                        />\n                        <button\n                          class=\"count\"\n                          onClick={() => this.increaseQuantity(index)}\n                        >\n                          +\n                        </button>\n                      </div>\n                      <div class=\"col-price\">\n                        <span class=\"product-price\">\n                          {product.product.price}\n                        </span>\n                        <span class=\"product-currency currency\">€</span>\n                      </div>\n                      <div class=\"col-total\">\n                        <span class=\"product-currency currency\">$</span>\n                        <span class=\"product-price\">\n                          {product.product.price * product.quantity}\n                        </span>\n                      </div>\n                    </li>\n                  ))}\n                </ul>\n              </section>\n              <aside class=\"summary\">\n                <h1 class=\"main\">Order Summary</h1>\n                <ul class=\"summary-items wrapper border\">\n                  <li>\n                    <span class=\"summary-items-number\">\n                      {Products.length} Items\n                    </span>\n                    <span class=\"summary-items-price\">\n                      $<span class=\"currency\">{total}</span>\n                    </span>\n                  </li>\n                </ul>\n                {/* <div class=\"summary-discounts wrapper-half border\">\n                  <h2>Discounts</h2>\n                  <ul>\n                    <li>\n                      <span>2x1 Mug offer</span>\n                      <span>-10€</span>\n                    </li>\n                    <li>\n                      <span>x3 Shirt offer</span>\n                      <span>-3€</span>\n                    </li>\n                    <li>\n                      <span>Promo code</span>\n                      <span>0€</span>\n                    </li>\n                  </ul>\n                </div> */}\n                <div class=\"summary-total wrapper\">\n                  <ul>\n                    <li>\n                      <span class=\"summary-total-cost\">Total cost</span>\n                      <span class=\"summary-total-price\">${total}</span>\n                    </li>\n                  </ul>\n                  <button type=\"submit\" onClick={this.handleCheckout}>\n                    Checkout\n                  </button>\n                </div>\n              </aside>\n            </main>\n          </div>\n        </body>\n      </html>\n    );\n  }\n}\n\nexport default CartPage;\n"]},"metadata":{},"sourceType":"module"}